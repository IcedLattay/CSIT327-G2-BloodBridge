{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <!-- for animations -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script> 
    <!-- for date/time pickers -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="{% static 'css/global-styles.css' %}">
    <link rel="stylesheet" href="{% static 'css/request-blood-styles.css' %}">
</head>

<body>
    {% include 'header.html' %}


    <!-- MAIN CONTENT -->
    <main class="container">
        <div class="card request-blood">
            <h2 class="red">Request Blood</h2>
            <div class="red h-divider"></div>
            
            <!-- Scrollable donation list -->

            {% if hospitals %}
            <div class="red hospital-available-list">
                
                {% for hospital in hospitals %}
                
                <p class="orange row">{{ hospital.profile.hospital_name }}</p>
                
                {% endfor %}
            
            </div>
            {% else %}
                <p class="orange empty-text">No hospitals available yet.</p>
            {% endif %}
        </div>



        <!-- REQUEST FORM -->

        <div class="modal" id="request-modal" >
            <form class="red card form" id="request-form">
                
                <p class="red label">Blood Request Form</p>

                <div class="red fields-group">
                    <div class="orange section blood">
                        <div class="yellow field bt">
                            <p class="green">Blood Type</p>
                            <input type="hidden" name="blood_type" id="selected-blood-type" value="">
                            <div class="green dropdown-bt">
                                <p class="blue dropdown-bt-btn" id="dropdown-bt-btn">A+ / B+ / O</p>
                                <div class="blue dropdown-bt-content-bg">
                                    <div class="indigo dropdown-bt-content" id="dropdown-bt-content">
                                        {% for bt in blood_types %}
                                        <p data-value="{{ bt.id }}" class="brown dropdown-bt-option 
                                                                            {% if forloop.first %}first{% endif %}
                                                                            {% if forloop.last %}last{% endif %}">{{ bt.type }}</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="green error-container" data-id="blood_type-error-container">
                                <svg class="blue icon" xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 26 24">
                                    <path d="m22.536,8.46L15.537,1.459C14.592.515,13.337-.006,12.001-.006s-2.592.521-3.536,1.465L1.466,8.46c-1.949,1.949-1.949,5.12,0,7.069l6.999,7.001c.944.944,2.2,1.465,3.536,1.465s2.591-.521,3.536-1.465l6.999-7.001c.944-.944,1.464-2.199,1.464-3.534s-.52-2.591-1.464-3.535Zm-1.414,5.655l-6.999,7.001c-1.134,1.133-3.11,1.133-4.244,0l-6.999-7.001c-1.169-1.169-1.169-3.072,0-4.241l6.999-7.001c.567-.566,1.32-.879,2.122-.879s1.555.312,2.122.879l6.999,7.001c.566.566.878,1.319.878,2.121s-.312,1.554-.878,2.12Zm-7.622,2.385c0,.828-.672,1.5-1.5,1.5s-1.5-.672-1.5-1.5.672-1.5,1.5-1.5,1.5.672,1.5,1.5Zm-2.5-4v-5.5c0-.553.448-1,1-1s1,.447,1,1v5.5c0,.553-.448,1-1,1s-1-.447-1-1Z"/>
                                </svg>
                                <p class="blue custom-error"></p>
                            </div>
                        </div>

                        <div class="yellow field quantity">
                            <p class="green">Quantity</p>
                            <div class="green quantity-field">
                                <input class="blue" type="number" min="1" step="1" oninput="if(this.value < 1) this.value = 1;" value="1" name="quantity" id="quantity-field">
                                <p class="blue">units</p>
                            </div>
                        </div>
                    </div>
                    <div class="orange section urgencies">
                        <div class="yellow field urgencies">
                            <p class="green">Urgency</p>
                            <input type="hidden" name="urgency" id="selected-urgency">
                            <div class="green urgency-selection">
                                <button class="blue" type="button" data-value="low">Low</button>
                                <button class="blue" type="button" data-value="medium">Medium</button>
                                <button class="blue" type="button" data-value="high">High</button>
                            </div>
                        </div>
                    </div>
                    <div class="orange section notes">
                        <div class="yellow field notes">
                            <p class="blue">Notes</p>
                            <textarea class="blue input notes" maxlength="225" name="notes" placeholder="Start typing here..." value='' id="notes-field"></textarea>
                        </div>
                    </div>
                </div>
                <div class="red form-buttons">
                    <button type="button" class="orange negative">Cancel</button>
                    <button type="submit" class="orange positive">Create Request</button>
                </div>
                
            </form>
        </div>

        <div class="modal" id="success-modal">
            <div class="red success card">
                <lottie-player
                    class="orange"
                    id="success-animation"
                    src="{% static 'animations/request-sent.json' %}"
                    background="transparent"
                    speed="1"
                    style="width: 150px; height: 150px;"
                    autoplay>
                </lottie-player>
                <p class="orange">Request sent!</p>
            </div>
        </div>
    </main>

    <script src="{% static 'js/request-blood-script.js' %}"></script>
</body>

</html>